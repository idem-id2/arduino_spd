# üîç –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Arduino

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
2. [–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤](#–ø—Ä–æ—Ü–µ—Å—Å-–ø–æ–∏—Å–∫–∞-—É—Å—Ç—Ä–æ–π—Å—Ç–≤)
3. [–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è](#–ø—Ä–æ—Ü–µ—Å—Å-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
4. [–ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±—â–µ–Ω–∏—è](#–ø—Ä–æ—Ç–æ–∫–æ–ª-–æ–±—â–µ–Ω–∏—è)
5. [–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-—Å–æ–±—ã—Ç–∏–π)
6. [–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](#–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)
7. [–°–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã](#—Å–æ—Å—Ç–æ—è–Ω–∏—è-—Å–∏—Å—Ç–µ–º—ã)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∏—Å–∫–∞ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Arduino —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **—Ç—Ä–µ—Ö —Å–ª–æ–µ–≤**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ViewModel Layer                        ‚îÇ
‚îÇ  ArduinoConnectionViewModel.cs          ‚îÇ  ‚Üê –ü—Ä–∏–≤—è–∑–∫–∞ –∫ UI
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Service Layer                          ‚îÇ
‚îÇ  ArduinoService.cs                     ‚îÇ  ‚Üê –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Hardware Layer                         ‚îÇ
‚îÇ  Arduino.cs                             ‚îÇ  ‚Üê –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å COM-–ø–æ—Ä—Ç–æ–º
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- **Hardware Layer** (`Arduino/Hardware/Arduino.cs`) ‚Äî —Ä–∞–±–æ—Ç–∞ —Å Serial –ø–æ—Ä—Ç–æ–º –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º Arduino
- **Service Layer** (`Arduino/Services/ArduinoService.cs`) ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- **ViewModel Layer** (`Arduino/ViewModels/ArduinoConnectionViewModel.cs`) ‚Äî –ø—Ä–∏–≤—è–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫ UI

---

## üîé –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (`ScanAsync`)

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

**–ú–µ—Ç–æ–¥:** `ArduinoService.ScanAsync()` (—Å—Ç—Ä–æ–∫–∏ 68-151)

```csharp
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   ‚îî‚îÄ –ï—Å–ª–∏ —É–∂–µ –∏–¥–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí –≤—ã—Ö–æ–¥

2. –°–æ–∑–¥–∞–Ω–∏–µ CancellationToken
   ‚îî‚îÄ –î–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–∏

3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ COM-–ø–æ—Ä—Ç–æ–≤
   ‚îî‚îÄ SerialPort.GetPortNames()
   ‚îî‚îÄ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∏–º–µ–Ω–∏ (case-insensitive)

4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞:
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–º–µ–Ω—ã (token.IsCancellationRequested)
   ‚îú‚îÄ –í—ã–∑–æ–≤ ProbePortWithTimeoutAsync() —Å —Ç–∞–π–º–∞—É—Ç–æ–º 5 —Å–µ–∫—É–Ω–¥
   ‚îî‚îÄ –ï—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–æ–∫ discovered

5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
   ‚îî‚îÄ Dispatcher.Invoke() –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   ‚îî‚îÄ –û—á–∏—Å—Ç–∫–∞ Devices –∫–æ–ª–ª–µ–∫—Ü–∏–∏
   ‚îî‚îÄ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   ‚îî‚îÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–µ—Ä–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

6. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   ‚îî‚îÄ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
   ‚îî‚îÄ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   ‚îî‚îÄ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ (`ProbePort`)

**–ú–µ—Ç–æ–¥:** `ArduinoService.ProbePort()` (—Å—Ç—Ä–æ–∫–∏ 863-913)

```csharp
1. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ Arduino –æ–±—ä–µ–∫—Ç–∞
   ‚îú‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:
   ‚îÇ  ‚îú‚îÄ BaudRate: 115200
   ‚îÇ  ‚îú‚îÄ DtrEnable: true
   ‚îÇ  ‚îú‚îÄ RtsEnable: true
   ‚îÇ  ‚îî‚îÄ Timeout: 3 —Å–µ–∫—É–Ω–¥—ã (–º–µ–Ω—å—à–µ, —á–µ–º –¥–ª—è —Ä–∞–±–æ—Ç—ã)
   ‚îî‚îÄ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è using –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

2. –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   ‚îú‚îÄ device.Connect()
   ‚îÇ  ‚îú‚îÄ –û—Ç–∫—Ä—ã—Ç–∏–µ COM-–ø–æ—Ä—Ç–∞
   ‚îÇ  ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã TEST ('t')
   ‚îÇ  ‚îî‚îÄ –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
   ‚îî‚îÄ –ï—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ:
      ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—à–∏–≤–∫–∏ (Command.VERSION)
      ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Command.NAME)
      ‚îî‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ ArduinoDeviceInfo –æ–±—ä–µ–∫—Ç–∞

3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   ‚îú‚îÄ TimeoutException ‚Üí –ø–æ—Ä—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç Arduino (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)
   ‚îú‚îÄ –î—Ä—É–≥–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è ‚Üí –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—Ç null
   ‚îî‚îÄ finally –±–ª–æ–∫:
      ‚îî‚îÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```

### –¢–∞–π–º–∞—É—Ç—ã –∏ –∑–∞—â–∏—Ç–∞

- **–í–Ω–µ—à–Ω–∏–π —Ç–∞–π–º–∞—É—Ç:** 5 —Å–µ–∫—É–Ω–¥ (`PortProbeTimeout`)
- **–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–∞–π–º–∞—É—Ç:** 3 —Å–µ–∫—É–Ω–¥—ã (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–∞ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
- **–û—Ç–º–µ–Ω–∞:** —á–µ—Ä–µ–∑ `CancellationToken`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ:** –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç–∞

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
–ó–∞–ø—É—Å–∫ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Arduino...
COM3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞...
COM3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞.
COM3: Arduino –æ–±–Ω–∞—Ä—É–∂–µ–Ω (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ 234 –º—Å).
COM4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞...
COM4: –¢–∞–π–º-–∞—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏.
–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Arduino –∑–∞–≤–µ—Ä—à–µ–Ω–æ. –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–æ—Ä—Ç–æ–≤: 2, –Ω–∞–π–¥–µ–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤: 1, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 1234 –º—Å.
```

---

## üîå –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (`ConnectAsync`)

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

**–ú–µ—Ç–æ–¥:** `ArduinoService.ConnectAsync()` (—Å—Ç—Ä–æ–∫–∏ 153-267)

```csharp
1. –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
   ‚îú‚îÄ –£–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω? ‚Üí –≤—ã—Ö–æ–¥
   ‚îú‚îÄ –£–∂–µ –∏–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ? ‚Üí –≤—ã—Ö–æ–¥
   ‚îî‚îÄ –í—ã–±—Ä–∞–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ? ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –≤—ã—Ö–æ–¥

2. –°–æ–∑–¥–∞–Ω–∏–µ Arduino –æ–±—ä–µ–∫—Ç–∞
   ‚îú‚îÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã:
   ‚îÇ  ‚îú‚îÄ BaudRate: 115200
   ‚îÇ  ‚îú‚îÄ DtrEnable: true
   ‚îÇ  ‚îú‚îÄ RtsEnable: true
   ‚îÇ  ‚îî‚îÄ Timeout: 10 —Å–µ–∫—É–Ω–¥ (–¥–ª—è —Ä–∞–±–æ—Ç—ã)
   ‚îî‚îÄ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ _activeDevice

3. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–≤ Task.Run –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)
   ‚îú‚îÄ device.Connect()
   ‚îÇ  ‚îú‚îÄ –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–∞
   ‚îÇ  ‚îî‚îÄ –ö–æ–º–∞–Ω–¥–∞ TEST –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤—è–∑–∏
   ‚îÇ
   ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:
   ‚îÇ  ‚îú‚îÄ –í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ (Command.VERSION)
   ‚îÇ  ‚îú‚îÄ –ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Command.NAME)
   ‚îÇ  ‚îú‚îÄ –ß–∞—Å—Ç–æ—Ç–∞ I2C (Command.I2CCLOCK)
   ‚îÇ  ‚îÇ  ‚îî‚îÄ 100 kHz (Standard) –∏–ª–∏ 400 kHz (Fast)
   ‚îÇ  ‚îú‚îÄ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ RSWP (Command.RSWPREPORT)
   ‚îÇ  ‚îÇ  ‚îî‚îÄ –ë–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞: DDR3, DDR4, DDR5
   ‚îÇ  ‚îî‚îÄ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ I2C —à–∏–Ω—ã (Command.SCANBUS)
   ‚îÇ     ‚îú‚îÄ –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ –∞–¥—Ä–µ—Å–∞—Ö 0x50-0x57
   ‚îÇ     ‚îî‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ª–∏—á–∏—è SPD EEPROM
   ‚îÇ
   ‚îî‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤

4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   ‚îú‚îÄ –ï—Å–ª–∏ SPD –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞:
   ‚îÇ  ‚îú‚îÄ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏ (DDR4/DDR5)
   ‚îÇ  ‚îÇ  ‚îî‚îÄ RefreshMemoryTypeAsync()
   ‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è RSWP –±–ª–æ–∫–æ–≤
   ‚îÇ     ‚îî‚îÄ CheckRswpAsync()
   ‚îÇ
   ‚îú‚îÄ –ï—Å–ª–∏ SPD –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞:
   ‚îÇ  ‚îú‚îÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏ –≤ Unknown
   ‚îÇ  ‚îî‚îÄ –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è RSWP
   ‚îÇ
   ‚îú‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ConnectionInfo
   ‚îÇ  ‚îî‚îÄ –ü–æ—Ä—Ç, –ø—Ä–æ—à–∏–≤–∫–∞, –∏–º—è, —á–∞—Å—Ç–æ—Ç–∞ I2C, RSWP –ø–æ–¥–¥–µ—Ä–∂–∫–∞
   ‚îÇ
   ‚îî‚îÄ –í—ã–∑–æ–≤ —Å–æ–±—ã—Ç–∏—è ConnectionStateChanged(true)

5. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
   ‚îú‚îÄ AlertReceived ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å—Ç–∞–≤–∫–∏/–∏–∑–≤–ª–µ—á–µ–Ω–∏—è SPD
   ‚îî‚îÄ ConnectionLost ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–µ—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```

### –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–ú–µ—Ç–æ–¥:** `Arduino.Connect()` (—Å—Ç—Ä–æ–∫–∏ 60-106)

```csharp
1. –°–æ–∑–¥–∞–Ω–∏–µ SerialPort
   ‚îú‚îÄ PortName, BaudRate, DtrEnable, RtsEnable
   ‚îú‚îÄ ReadTimeout: 1000 –º—Å
   ‚îú‚îÄ WriteTimeout: 1000 –º—Å
   ‚îî‚îÄ ReceivedBytesThreshold: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞

2. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
   ‚îú‚îÄ DataReceived ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   ‚îî‚îÄ ErrorReceived ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ—Ä—Ç–∞

3. –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—Ä—Ç–∞
   ‚îî‚îÄ _serialPort.Open()

4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
   ‚îî‚îÄ ExecuteCommand(Command.TEST)
      ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–∫–∞ –±–∞–π—Ç–∞ 't'
      ‚îú‚îÄ –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º '&'
      ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ checksum

5. –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
   ‚îî‚îÄ Task –∫–∞–∂–¥—ã–µ 500 –º—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç IsConnected
      ‚îî‚îÄ –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Üí —Å–æ–±—ã—Ç–∏–µ ConnectionLost
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
COM3: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É
COM3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏
COM3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∞—Å—Ç–æ—Ç—ã I2C
COM3: –ß–∞—Å—Ç–æ—Ç–∞ I2C –ë—ã—Å—Ç—Ä–∞—è (400 –∫–ì—Ü)
COM3: –ü—Ä–æ–≤–µ—Ä–∫–∞ RSWP
COM3: DDR5 RSWP –¥–æ—Å—Ç—É–ø–µ–Ω
COM3: DDR4 RSWP –¥–æ—Å—Ç—É–ø–µ–Ω
COM3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏–Ω—ã I2C
COM3: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –Ω–æ–≤–∞—è SPD EEPROM
COM3 –ø–æ–¥–∫–ª—é—á–µ–Ω (–ò–º—è: MyArduino, FW: v.2)
COM3: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ DDR5 SPD.
COM3: –°—Ç–∞—Ç—É—Å RSWP:
COM3: –ë–ª–æ–∫ 0 [–ù–µ –∑–∞—â–∏—â–µ–Ω]
COM3: –ë–ª–æ–∫ 1 [–ù–µ –∑–∞—â–∏—â–µ–Ω]
...
```

---

## üì° –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±—â–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç –ø–∞–∫–µ—Ç–æ–≤

```
[Header: 1 –±–∞–π—Ç] [Length: 1 –±–∞–π—Ç] [Body: 0-32 –±–∞–π—Ç–∞] [Checksum: 1 –±–∞–π—Ç]

Header:
  - '&' (0x26) = RESPONSE (–æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É)
  - '@' (0x40) = ALERT (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ)

Length: —Ä–∞–∑–º–µ—Ä Body (0-32)

Body: –¥–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –æ—Ç–≤–µ—Ç–∞

Checksum: —Å—É–º–º–∞ –≤—Å–µ—Ö –±–∞–π—Ç–æ–≤ Body
```

### –ö–æ–º–∞–Ω–¥—ã Arduino

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤:** `Arduino.cs` (—Å—Ç—Ä–æ–∫–∏ 810-826)

```csharp
Command.TEST = 't'           // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
Command.VERSION = 'v'        // –í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏
Command.NAME = 'n'           // –ò–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (GET/SET)
Command.I2CCLOCK = 'c'       // –ß–∞—Å—Ç–æ—Ç–∞ I2C (GET/SET)
Command.SCANBUS = 's'       // –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ I2C —à–∏–Ω—ã
Command.READBYTE = 'r'      // –ß—Ç–µ–Ω–∏–µ –±–∞–π—Ç–∞ –∏–∑ SPD
Command.WRITEBYTE = 'w'     // –ó–∞–ø–∏—Å—å –±–∞–π—Ç–∞ –≤ SPD
Command.WRITEPAGE = 'g'     // –ó–∞–ø–∏—Å—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–¥–æ 32 –±–∞–π—Ç)
Command.RSWP = 'b'          // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ RSWP
Command.RSWPREPORT = 'f'    // –û—Ç—á–µ—Ç –æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ RSWP
Command.DDR4DETECT = '4'    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ DDR4
Command.DDR5DETECT = '5'    // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ DDR5
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤

**–ú–µ—Ç–æ–¥:** `Arduino.ExecuteCommand()` (—Å—Ç—Ä–æ–∫–∏ 690-734)

```csharp
1. –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–æ–≤
   ‚îî‚îÄ ClearBuffer() - —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

2. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥—ã
   ‚îî‚îÄ BaseStream.Write(command)
   ‚îî‚îÄ BaseStream.Flush()

3. –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
   ‚îî‚îÄ AutoResetEvent (DataReady)
   ‚îî‚îÄ –¢–∞–π–º–∞—É—Ç: PortSettings.Timeout —Å–µ–∫—É–Ω–¥

4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
   ‚îú‚îÄ –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å '&' (RESPONSE)
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ checksum
   ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—Ç Body –ø–∞–∫–µ—Ç–∞

5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
   ‚îú‚îÄ TimeoutException ‚Üí —Ç–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞
   ‚îú‚îÄ InvalidDataException ‚Üí –æ—à–∏–±–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
   ‚îî‚îÄ –ü—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ ‚Üí —Å–æ–±—ã—Ç–∏–µ ConnectionLost
```

### –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã

**–ß—Ç–µ–Ω–∏–µ –±–∞–π—Ç–∞ –∏–∑ SPD:**
```csharp
byte[] command = {
    Command.READBYTE,  // 'r'
    I2CAddress,         // 0x50
    (byte)(offset >> 8), // —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç offset
    (byte)offset,      // –º–ª–∞–¥—à–∏–π –±–∞–π—Ç offset
    1                  // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç
};

byte[] response = ExecuteCommand(command);
byte value = response[0]; // –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

---

## üéØ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π

### Alert —Å–æ–±—ã—Ç–∏—è

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫:** `ArduinoService.HandleAlert()` (—Å—Ç—Ä–æ–∫–∏ 915-943)

#### SlaveIncrement ('+')
```csharp
–°–æ–±—ã—Ç–∏–µ: SPD EEPROM –≤—Å—Ç–∞–≤–ª–µ–Ω–∞

–î–µ–π—Å—Ç–≤–∏—è:
‚îú‚îÄ _spdReady = true
‚îú‚îÄ SpdStateChanged?.Invoke(this, true)
‚îú‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –Ω–æ–≤–∞—è SPD EEPROM"
‚îî‚îÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
   ‚îú‚îÄ RefreshMemoryTypeAsync() - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–∞–º—è—Ç–∏
   ‚îî‚îÄ CheckRswpAsync() - –ø—Ä–æ–≤–µ—Ä–∫–∞ RSWP —Å–æ—Å—Ç–æ—è–Ω–∏—è
```

#### SlaveDecrement ('-')
```csharp
–°–æ–±—ã—Ç–∏–µ: SPD EEPROM –∏–∑–≤–ª–µ—á–µ–Ω–∞

–î–µ–π—Å—Ç–≤–∏—è:
‚îú‚îÄ _spdReady = false
‚îú‚îÄ SpdStateChanged?.Invoke(this, false)
‚îú‚îÄ UpdateMemoryType(SpdMemoryType.Unknown)
‚îú‚îÄ RswpStateChanged?.Invoke(this, Array.Empty<bool>())
‚îî‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: "SPD EEPROM –∏–∑–≤–ª–µ—á–µ–Ω–∞"
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–ú–µ—Ç–æ–¥:** `Arduino.StartConnectionMonitor()` (—Å—Ç—Ä–æ–∫–∏ 594-640)

```csharp
–ó–∞–ø—É—Å–∫: –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ (Connect())

–ê–ª–≥–æ—Ä–∏—Ç–º:
‚îú‚îÄ –°–æ–∑–¥–∞–Ω–∏–µ Task —Å CancellationToken
‚îú‚îÄ –¶–∏–∫–ª –∫–∞–∂–¥—ã–µ 500 –º—Å:
‚îÇ  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ IsConnected
‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ false ‚Üí OnConnectionLost()
‚îî‚îÄ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –∏–ª–∏ –æ—Ç–º–µ–Ω–µ
```

### –°–æ–±—ã—Ç–∏—è Service Layer

```csharp
LogGenerated             // –õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü–∏–π (Info/Warn/Error)
ConnectionStateChanged   // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ (bool)
SpdStateChanged          // SPD –æ–±–Ω–∞—Ä—É–∂–µ–Ω/—É–¥–∞–ª–µ–Ω (bool)
ConnectionInfoChanged    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (ArduinoConnectionInfo)
RswpStateChanged         // –°—Ç–∞—Ç—É—Å RSWP –±–ª–æ–∫–æ–≤ (bool[])
MemoryTypeChanged        // –¢–∏–ø –ø–∞–º—è—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω (SpdMemoryType)
StateChanged             // –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (EventArgs)
```

---

## ‚öôÔ∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

```csharp
// –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ—Ä—Ç–æ–º –∑–∞—â–∏—â–µ–Ω—ã lock
lock (_portLock)
{
    // –û–ø–µ—Ä–∞—Ü–∏–∏ —Å SerialPort
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–º lock
lock (_receiveLock)
{
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ DataReceived
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI —á–µ—Ä–µ–∑ Dispatcher
Application.Current.Dispatcher.Invoke(() =>
{
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI —ç–ª–µ–º–µ–Ω—Ç–æ–≤
});
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```csharp
TimeoutException
‚îî‚îÄ –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ—Ä—Ç–æ–≤
‚îî‚îÄ –ü–æ—Ä—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç Arduino —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

InvalidDataException
‚îî‚îÄ –û—à–∏–±–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–Ω–µ–≤–µ—Ä–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫/checksum)
‚îî‚îÄ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ

IOException
‚îî‚îÄ –û—à–∏–±–∫–∞ –ø–æ—Ä—Ç–∞ (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ)
‚îî‚îÄ –°–æ–±—ã—Ç–∏–µ ConnectionLost

–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è LogGenerated
```

### 3. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```csharp
_cachedAddresses
‚îî‚îÄ –ö—ç—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è I2C —à–∏–Ω—ã
‚îî‚îÄ –û—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏

_rswpTypeSupport
‚îî‚îÄ –ö—ç—à –ø–æ–¥–¥–µ—Ä–∂–∫–∏ RSWP —Ç–∏–ø–æ–≤
‚îî‚îÄ –û—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
```

### 4. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

```csharp
// –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ I/O –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ Task.Run()
await Task.Run(() =>
{
    // –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ—Ä—Ç–æ–º
}).ConfigureAwait(true); // –í–æ–∑–≤—Ä–∞—Ç –≤ UI –ø–æ—Ç–æ–∫

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CancellationToken –¥–ª—è –æ—Ç–º–µ–Ω—ã
var token = _scanCancellation.Token;
if (token.IsCancellationRequested)
{
    // –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
}
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–∞

```csharp
// –î–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–±—ã—Å—Ç—Ä–µ–µ, –º–µ–Ω—å—à–µ —Ç–∞–π–º–∞—É—Ç)
var scanPortSettings = new SerialPortSettings(
    baudRate: 115200,
    dtrEnable: true,
    rtsEnable: true,
    timeout: 3  // —Å–µ–∫—É–Ω–¥—ã
);

// –î–ª—è —Ä–∞–±–æ—Ç—ã (–Ω–∞–¥–µ–∂–Ω–µ–µ, –±–æ–ª—å—à–µ —Ç–∞–π–º–∞—É—Ç)
var portSettings = new SerialPortSettings(
    baudRate: 115200,
    dtrEnable: true,
    rtsEnable: true,
    timeout: 10  // —Å–µ–∫—É–Ω–¥—ã
);
```

---

## üìä –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

### –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π

```
[–ù–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ]
    ‚îÇ
    ‚ñº
[Scanning] ‚îÄ‚îÄScanAsync()‚îÄ‚îÄ‚ñ∫ [Devices populated]
    ‚îÇ                              ‚îÇ
    ‚îÇ                              ‚ñº
    ‚îÇ                    [SelectedDevice set]
    ‚îÇ                              ‚îÇ
    ‚îÇ                              ‚ñº
    ‚îÇ                    [ConnectAsync] ‚îÄ‚îÄ‚ñ∫ [Connecting]
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îÇ                                    [Connected]
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îÇ                                    [SPD Detection]
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îÇ                                    [SPD Ready]
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îÇ                                    [Memory Type Detected]
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îÇ                                    [RSWP Check]
    ‚îÇ                                            ‚îÇ
    ‚îÇ                                            ‚ñº
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ [Ready for operations]
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### ArduinoService
```csharp
IsScanning: bool      // –ò–¥–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤
IsConnecting: bool    // –ò–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
IsConnected: bool     // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
IsReading: bool       // –ò–¥–µ—Ç —á—Ç–µ–Ω–∏–µ SPD
IsSpdReady: bool      // SPD EEPROM –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞
ActiveMemoryType: SpdMemoryType  // DDR4/DDR5/Unknown
ActiveRswpBlockCount: int        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ RSWP –±–ª–æ–∫–æ–≤
```

#### Arduino (Hardware)
```csharp
IsConnected: bool     // –ü–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
I2CAddress: byte     // –¢–µ–∫—É—â–∏–π –∞–¥—Ä–µ—Å I2C (0x50-0x57)
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã Serial Port

```csharp
BaudRate: 115200      // –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏
DtrEnable: true       // Data Terminal Ready
RtsEnable: true       // Request To Send
ReadTimeout: 1000     // –¢–∞–π–º–∞—É—Ç —á—Ç–µ–Ω–∏—è (–º—Å)
WriteTimeout: 1000    // –¢–∞–π–º–∞—É—Ç –∑–∞–ø–∏—Å–∏ (–º—Å)
```

### –¢–∞–π–º–∞—É—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π

| –û–ø–µ—Ä–∞—Ü–∏—è | –¢–∞–π–º–∞—É—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|---------|----------|
| –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞ | 5 —Å–µ–∫ | –í–Ω–µ—à–Ω–∏–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è ProbePort |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞ | 3 —Å–µ–∫ | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |
| –ö–æ–º–∞–Ω–¥–∞ Arduino | 10 —Å–µ–∫ | –¢–∞–π–º–∞—É—Ç –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã |
| –ß—Ç–µ–Ω–∏–µ SPD | ~3-5 —Å–µ–∫ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ (512/1024 –±–∞–π—Ç) |
| –ó–∞–ø–∏—Å—å SPD | ~10-15 —Å–µ–∫ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –∏ –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ |

### I2C –∞–¥—Ä–µ—Å–∞

```csharp
–î–∏–∞–ø–∞–∑–æ–Ω: 0x50 - 0x57
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0x50

–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
‚îú‚îÄ –ö–æ–º–∞–Ω–¥–∞ SCANBUS –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∏—Ç–æ–≤—É—é –º–∞—Å–∫—É
‚îú‚îÄ –ë–∏—Ç 0 = –∞–¥—Ä–µ—Å 0x50
‚îú‚îÄ –ë–∏—Ç 1 = –∞–¥—Ä–µ—Å 0x51
‚îî‚îÄ ...
‚îî‚îÄ –ë–∏—Ç 7 = –∞–¥—Ä–µ—Å 0x57
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

```csharp
// –í ViewModel
await _arduinoService.ScanAsync();

// –†–µ–∑—É–ª—å—Ç–∞—Ç
// Devices –∫–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
// SelectedDevice –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ø–µ—Ä–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
```

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É

```csharp
// –í—ã–±–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
_arduinoService.SetSelectedDevice(device);

// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
await _arduinoService.ConnectAsync();

// –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
_arduinoService.ConnectionStateChanged += OnConnectionChanged;
_arduinoService.SpdStateChanged += OnSpdChanged;
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π

```csharp
private void OnConnectionChanged(object? sender, bool isConnected)
{
    if (isConnected)
    {
        // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
        // –ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å —Ä–∞–±–æ—Ç—É
    }
    else
    {
        // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç–∫–ª—é—á–µ–Ω–æ
        // –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    }
}

private void OnSpdChanged(object? sender, bool isSpdReady)
{
    if (isSpdReady)
    {
        // SPD –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞
        // –ú–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
    }
    else
    {
        // SPD –∏–∑–≤–ª–µ—á–µ–Ω–∞
        // –û–∂–∏–¥–∞–Ω–∏–µ –≤—Å—Ç–∞–≤–∫–∏
    }
}
```

---

## üêõ –û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏–µ `LogGenerated`:

```csharp
_arduinoService.LogGenerated += (sender, e) =>
{
    Console.WriteLine($"[{e.Level}] {e.Message}");
};
```

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
```
–ü—Ä–∏—á–∏–Ω—ã:
‚îú‚îÄ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π COM-–ø–æ—Ä—Ç
‚îú‚îÄ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
‚îú‚îÄ –î—Ä–∞–π–≤–µ—Ä—ã –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
‚îî‚îÄ –î—Ä—É–≥–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞ –ø–æ—Ä—Ç—É

–†–µ—à–µ–Ω–∏–µ:
‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Device Manager
‚îî‚îÄ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç
‚îî‚îÄ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
```

#### 2. –¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
```
–ü—Ä–∏—á–∏–Ω—ã:
‚îú‚îÄ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞–Ω—è—Ç–æ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π
‚îú‚îÄ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏
‚îî‚îÄ –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–∞–±–µ–ª–µ–º

–†–µ—à–µ–Ω–∏–µ:
‚îî‚îÄ –ó–∞–∫—Ä—ã—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ—Ä—Ç
‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–∞
‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–±–µ–ª—å
```

#### 3. SPD –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞
```
–ü—Ä–∏—á–∏–Ω—ã:
‚îú‚îÄ SPD EEPROM –Ω–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞
‚îú‚îÄ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π I2C –∞–¥—Ä–µ—Å
‚îî‚îÄ –ü—Ä–æ–±–ª–µ–º—ã —Å I2C —à–∏–Ω–æ–π

–†–µ—à–µ–Ω–∏–µ:
‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å—Ç–∞–≤–∫—É SPD
‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥—Ä–µ—Å I2C
‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ I2C
```

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **Arduino/README.md** - –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è Arduino
- **Arduino/firmware/README.md** - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—à–∏–≤–∫–∏ Arduino
- **Arduino/FIRMWARE_UPDATE.md** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—à–∏–≤–∫–∏

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2025-12-10  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ

